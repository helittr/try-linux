# RootFs

你可能听说这样一句话，linux 一切皆文件，各种总线 设备 调试系统 等都通过文件系统来向用户空间提供接口，并负责管理访问权限。几乎所有的接口都被抽象为文件，debugfs tmpfs 等。

操作系统的功能是管理各种硬件资源，为各种应用程序服务，一个不运行程序的系统是没有意义的。这就是 rootfs 存在的意义，负责存初始化配置,用户程序，运行库等。 把最终控制权交给用用户应用程序。

## 文件系统

文件系统有通用的 FAT,FATFS windows 下的 NTFS linux EXT4 等，主要的作用就是规范文件的在存储设备上数据格式，负责文件的索引，加密，坏点管理等功能。不同的文件系统的存储格式不相同, 只能被特定的文件系统识别和处理。

Rootfs 也一样，它通过 `cpio` 程序制作的特定格式的数据，能被 linux 识别，并访问其中的文件。应为是第一个文件系统需要通过系统启动参数传递给内核。这跟启动应用程序通过命令行传递参数一样, 可以在启动时读取这些参数。启动时便会将它挂在在系统中。你可能了解 “树” 这种数据结构，文件的索引正式这种结构，与 window 不同的是， linux 只提供了一个根节点，你只能将分区挂载为目录，在 windows 提供了盘符概念，允许你将分区指定盘符。

### 分区

TODO: 待补充

## 制作根文件系统

你可能使用过 `tar` 这个程序，通常被用于打包压缩文件。[`cpio`](https://www.linuxjournal.com/article/1213) 根它很相似，主要的作用就是将文件打包并组织一块二进制数据。而这块数据是 linux 默认支持识别并解析的，你可把它当作一个文件系统。而其他三方文件系统需要定制内核以支持特定的文件系统。

参考资料：
- [The Linux Bootdisk HOWTO](https://tldp.org/HOWTO/Bootdisk-HOWTO/index.html)
